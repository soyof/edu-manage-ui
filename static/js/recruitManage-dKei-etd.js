import{y as e,r as a,c as t,z as l,R as o,J as s,I as i,L as n,u as r,al as d,B as u,P as p,O as c,E as m,Q as f,a6 as h,aD as b,A as w}from"./vue-BMnUnhjY.js";import{u as _,s as g}from"./index-BT6KgQx3.js";import{e as y,w as v,S as T,a3 as V,a4 as U,C as I,E as k}from"./elementPlus-iRxZk2_b.js";import{_ as C}from"./throttleButton.vue_vue_type_script_setup_true_lang-D3gBfjRi.js";import{T as R}from"./tablePage-YHXugbiE.js";import{a as A}from"./useDictionary-Cg9QFWfd.js";import{R as D}from"./statusConfig-Cju3zQbK.js";import{_ as x}from"./_plugin-vue_export-helper-BCo6x5W8.js";const j={class:"recruit-manage-container common-action-column"},O=["title","onClick"],P={class:"action-buttons"},Y=["onClick"],B=["onClick"],L=["onClick"],M=x(e({__name:"recruitManage",setup(e){const x=b(),M=_().isAdmin,{dictList:S,loading:$,getDictLabel:F}=A("recruitment_type",!0),N={recruitmentType:"",status:"",publishUserId:"",createUserId:"",updateUserId:"",publishTimesRange:[],updatedTimesRange:[]},W=a(),q=a([]),z=t(()=>!q.value.length||q.value.some(e=>"1"===e.status)),E=e=>{q.value=e},H=e=>g.post("/api/recruit/list",e),J=()=>{x.push({path:"/modifyRecruitInfo",query:{mode:"add",tabTitle:encodeURIComponent("新增招聘信息")}})},K=e=>{const a=e?[e.id]:q.value.map(e=>e.id);a.length&&I.confirm(`确认要删除${a.length>1?"选中的"+a.length+"条":"该"}招聘信息吗？此操作不可恢复！`,"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>g.post("/api/recruit/delete",{ids:a}).then(()=>{k.success("删除成功"),W.value?.getList(1)})).catch(()=>{})},Q=()=>{if(0===q.value.length)return void k.warning("请先选择要删除的招聘信息");0!==q.value.filter(e=>"1"!==e.status).length?K():k.warning("选中的招聘信息均为生效中状态，不能删除")};return(e,a)=>{const t=d("el-option"),b=d("el-select"),_=d("el-form-item"),A=d("el-col"),q=d("el-input"),G=d("el-date-picker"),X=d("el-icon"),Z=d("el-tooltip"),ee=d("el-table-column"),ae=d("el-tag");return w(),l("div",j,[o(R,{ref_key:"tablePageRef",ref:W,fetchData:H,initialSearchForm:N,onSelectionChange:E},{"search-form":s(({form:e})=>[o(A,{span:6},{default:s(()=>[o(_,{label:"招聘类型"},{default:s(()=>[o(b,{modelValue:e.recruitmentType,"onUpdate:modelValue":a=>e.recruitmentType=a,placeholder:"请选择招聘类型",clearable:"",loading:r($)},{default:s(()=>[(w(!0),l(f,null,h(r(S),e=>(w(),i(t,{key:e.dictId,label:e.dictValue,value:e.dictId},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024)]),_:2},1024),r(M)?(w(),i(A,{key:0,span:6},{default:s(()=>[o(_,{label:"状态"},{default:s(()=>[o(b,{modelValue:e.status,"onUpdate:modelValue":a=>e.status=a,placeholder:"请选择状态",clearable:""},{default:s(()=>[(w(!0),l(f,null,h(r(D).list,e=>(w(),i(t,{key:e.dictId,label:e.dictValue,value:e.dictId},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):n("",!0),o(A,{span:6},{default:s(()=>[o(_,{label:"创建人"},{default:s(()=>[o(q,{modelValue:e.createUserId,"onUpdate:modelValue":a=>e.createUserId=a,placeholder:"请输入创建人",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(A,{span:6},{default:s(()=>[o(_,{label:"更新人"},{default:s(()=>[o(q,{modelValue:e.updateUserId,"onUpdate:modelValue":a=>e.updateUserId=a,placeholder:"请输入更新人",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(A,{span:6},{default:s(()=>[o(_,{label:"发布人"},{default:s(()=>[o(q,{modelValue:e.publishUserId,"onUpdate:modelValue":a=>e.publishUserId=a,placeholder:"请输入发布人",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(A,{span:6},{default:s(()=>[o(_,{label:"发布时间"},{default:s(()=>[o(G,{modelValue:e.publishTimesRange,"onUpdate:modelValue":a=>e.publishTimesRange=a,type:"daterange",rangeSeparator:"~",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(A,{span:6},{default:s(()=>[o(_,{label:"更新时间"},{default:s(()=>[o(G,{modelValue:e.updatedTimesRange,"onUpdate:modelValue":a=>e.updatedTimesRange=a,type:"daterange",rangeSeparator:"~",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),operation:s(()=>[r(M)?(w(),l(f,{key:0},[o(Z,{content:"新增招聘信息",placement:"top",showAfter:200,hideAfter:0},{default:s(()=>[o(C,{size:"small",type:"primary",onClick:J},{default:s(()=>[o(X,null,{default:s(()=>[o(r(U))]),_:1})]),_:1})]),_:1}),o(Z,{content:"批量删除",placement:"top",showAfter:200,hideAfter:0},{default:s(()=>[o(C,{size:"small",type:"danger",disabled:z.value,onClick:Q},{default:s(()=>[o(X,null,{default:s(()=>[o(r(V))]),_:1})]),_:1},8,["disabled"])]),_:1})],64)):n("",!0)]),default:s(()=>[r(M)?(w(),i(ee,{key:0,type:"selection",width:"50",fixed:"left"})):n("",!0),o(ee,{prop:"id",label:"ID",width:"50"}),o(ee,{label:"招聘类型",minWidth:"180"},{default:s(e=>[u("span",{class:"clickable-title",title:r(F)(e.row.recruitmentType),onClick:a=>{return t=e.row,void x.push({path:"/recruitInfoDetail",query:{id:t.id,tabTitle:encodeURIComponent(`招聘信息详情【${F(t.recruitmentType)}】`)}});var t}},p(r(F)(e.row.recruitmentType)),9,O)]),_:1}),o(ee,{label:"状态",width:"120"},{default:s(e=>[o(ae,{type:r(D).getTagType(e.row.status)},{default:s(()=>[c(p(r(D).getName(e.row.status)),1)]),_:2},1032,["type"])]),_:1}),o(ee,{prop:"publishUserName",label:"发布人",width:"150",showOverflowTooltip:""}),o(ee,{prop:"publishTimes",label:"发布时间",minWidth:"180",showOverflowTooltip:""}),o(ee,{prop:"updateUserName",label:"更新人",width:"150",showOverflowTooltip:""}),o(ee,{prop:"updatedTimes",label:"更新时间",minWidth:"180",showOverflowTooltip:""}),o(ee,{prop:"createUserName",label:"创建人",width:"150",showOverflowTooltip:""}),o(ee,{prop:"createdTimes",label:"创建时间",minWidth:"180",showOverflowTooltip:""}),r(M)?(w(),i(ee,{key:1,label:"操作",width:"110",fixed:"right"},{default:s(e=>[u("div",P,[o(Z,{content:"1"===e.row.status?"生效中的信息不可编辑":"编辑",placement:"top",showAfter:200,hideAfter:0},{default:s(()=>[u("span",{class:m(["action-icon-wrapper",{"disabled-wrapper":"1"===e.row.status}]),onClick:a=>{return"1"!==e.row.status&&(t=e.row,void x.push({path:"/modifyRecruitInfo",query:{mode:"edit",id:t.id,tabTitle:encodeURIComponent(`编辑招聘信息【${F(t.recruitmentType)}】`)}}));var t}},[o(X,{class:"action-icon edit-icon"},{default:s(()=>[o(r(y))]),_:1})],10,Y)]),_:2},1032,["content"]),o(Z,{content:"1"===e.row.status?"存档":"发布",placement:"top",showAfter:200,hideAfter:0},{default:s(()=>[u("span",{class:"action-icon-wrapper",onClick:a=>((e,a)=>{const t="publish"===a,l=t?"发布":"存档",o=t?"确认发布该招聘信息":"存档",s=t?`发布后，此信息将成为唯一有效的【${F(e.recruitmentType)}】招聘信息，之前发布的同类型信息将自动归档。`:"确认要存档该招聘信息吗？存档后将不再生效";I.confirm(s,o,{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>g.post("/api/recruit/publish",{id:e.id,action:t?"publish":"archive"}).then(()=>{k.success(`${l}成功`),W.value?.getList(1)})).catch(()=>{})})(e.row,"1"===e.row.status?"archive":"publish")},[o(X,{class:m(["action-icon","1"===e.row.status?"unpublish-icon":"publish-icon"])},{default:s(()=>["1"===e.row.status?(w(),i(r(v),{key:0})):(w(),i(r(T),{key:1}))]),_:2},1032,["class"])],8,B)]),_:2},1032,["content"]),o(Z,{content:"1"===e.row.status?"生效中的信息不能删除":"删除",placement:"top",showAfter:200,hideAfter:0},{default:s(()=>[u("span",{class:m(["action-icon-wrapper",{"disabled-wrapper":"1"===e.row.status}]),onClick:a=>"1"!==e.row.status&&K(e.row)},[o(X,{class:"action-icon delete-icon"},{default:s(()=>[o(r(V))]),_:1})],10,L)]),_:2},1032,["content"])])]),_:1})):n("",!0)]),_:1},512)])}}}),[["__scopeId","data-v-51d5a2fe"]]);export{M as default};
