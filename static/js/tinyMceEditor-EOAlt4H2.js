import{j as e,y as n,af as t,r as o,h as i,X as a,Y as r,a3 as l,ab as s,n as u,aX as d,U as c,c as p,z as m,E as f,R as g,I as v,L as y,u as h,al as b,aE as C,A as _}from"./vue-BMnUnhjY.js";import{g as x,s as S}from"./index-BT6KgQx3.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";var k,V=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],A=function(e){return-1!==V.map(function(e){return e.toLowerCase()}).indexOf(e.toLowerCase())},I=function(n,t,o,i,a,r){i.setContent(r()),o.attrs["onUpdate:modelValue"]&&function(n,t,o,i){var a=n.modelEvents?n.modelEvents:null,r=Array.isArray(a)?a.join(" "):a;e(i,function(e,t){o&&"string"==typeof e&&e!==t&&e!==o.getContent({format:n.outputFormat})&&o.setContent(e)}),o.on(r||"change input undo redo",function(){t.emit("update:modelValue",o.getContent({format:n.outputFormat}))})}(t,o,i,a),function(e,n,t){Object.keys(n).filter(A).forEach(function(o){var i=n[o];"function"==typeof i&&("onInit"===o?i(e,t):t.on(o.substring(2),function(e){return i(e,t)}))})}(n,o.attrs,i)},D=0,E=function(e){var n=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++D+String(n)},M=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},j=function(e){var n;return"function"==typeof(null===(n=e.options)||void 0===n?void 0:n.set)&&e.options.isRegistered("disabled")},B=function(){return{listeners:[],scriptId:E("tiny-script"),scriptLoaded:!1}},O=(k=B(),{load:function(e,n,t){k.scriptLoaded?t():(k.listeners.push(t),e.getElementById(k.scriptId)||function(e,n,t,o){var i=n.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e,i.src=t;var a=function(){i.removeEventListener("load",a),o()};i.addEventListener("load",a),n.head&&n.head.appendChild(i)}(k.scriptId,e,n,function(){k.listeners.forEach(function(e){return e()}),k.scriptLoaded=!0}))},reinitialize:function(){k=B()}}),L=function(){return"undefined"!=typeof window?window:global},U=function(){var e=L();return e&&e.tinymce?e.tinymce:null},P={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,readonly:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},z=function(){return z=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},z.apply(this,arguments)},R={selector:void 0,target:void 0},H=function(e,n){var t;"function"==typeof(null===(t=e.mode)||void 0===t?void 0:t.set)?e.mode.set(n):e.setMode(n)},N=n({props:P,setup:function(n,d){var c=n.init?z(z({},n.init),R):z({},R),p=t(n),m=p.disabled,f=p.readonly,g=p.modelValue,v=p.tagName,y=o(null),h=null,b=n.id||E("tiny-vue"),C=n.init&&n.init.inline||n.inline,_=!!d.attrs["onUpdate:modelValue"],x=!0,S=n.initialValue?n.initialValue:"",w="",k=function(){var e,t,o,i=(e=x,_?function(){return(null==g?void 0:g.value)?g.value:""}:function(){return e?S:w}),a=z(z({},c),{disabled:n.disabled,readonly:n.readonly,target:y.value,plugins:(t=c.plugins,o=n.plugins,M(t).concat(M(o))),toolbar:n.toolbar||c.toolbar,inline:C,license_key:n.licenseKey,setup:function(e){j(h=e)||!0!==n.disabled||H(h,"readonly"),e.on("init",function(t){return I(t,n,d,e,g,i)}),"function"==typeof c.setup&&c.setup(e)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(y.value)&&(y.value.style.visibility=""),U().init(a),x=!1};e(f,function(e){null!==h&&H(h,e?"readonly":"design")}),e(m,function(e){null!==h&&(j(h)?h.options.set("disabled",e):H(h,e?"readonly":"design"))}),e(v,function(e){var n;h&&(_||(w=h.getContent()),null===(n=U())||void 0===n||n.remove(h),u(function(){return k()}))}),i(function(){if(null!==U())k();else if(y.value&&y.value.ownerDocument){var e=n.cloudChannel?n.cloudChannel:"8",t=n.apiKey?n.apiKey:"no-api-key",o=null==n.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(t,"/tinymce/").concat(e,"/tinymce.min.js"):n.tinymceScriptSrc;O.load(y.value.ownerDocument,o,k)}}),a(function(){null!==U()&&U().remove(h)}),C||(r(function(){x||k()}),l(function(){var e;h&&(_||(w=h.getContent()),null===(e=U())||void 0===e||e.remove(h))}));return d.expose({rerender:function(e){var n;h&&(w=h.getContent(),null===(n=U())||void 0===n||n.remove(h),c=z(z(z({},c),e),R),u(function(){return k()}))},getEditor:function(){return h}}),function(){return C?function(e,n,t,o){return e(o||"div",{id:n,ref:t})}(s,b,y,n.tagName):s("textarea",{id:b,visibility:"hidden",ref:y})}}});const K=(e,n)=>new Promise((n,t)=>{const o=new FormData;o.append("image",e.blob()),S.upload("/api/uploadImage",o).then(e=>{n(`/api/previewImage?filename=${e.url}`)}).catch(e=>{t(e)})}),F=w(n({__name:"tinyMceEditor",props:{modelValue:{type:String,default:""},disabled:{type:Boolean,default:!1},height:{type:Number,default:300},placeholder:{type:String,default:"开始编写吧"},customConfig:{type:Object,default:()=>({})},id:{type:String,default:""}},emits:["update:modelValue"],setup(e,{expose:n,emit:t}){C(n=>({"7cd47496":e.height}));const i=d("editorRef"),a=e,r=o(!1);c(()=>{r.value=!1}),l(()=>{r.value=!1});const s=t,u=p({get:()=>a.modelValue,set:e=>s("update:modelValue",e)}),S=p(()=>a.id||`editor_${(new Date).getTime()}_${x()}`),w=p(()=>{const e={promotion:!1,license_key:"gpl",width:"100%",menubar:!1,branding:!1,statusbar:!0,autosave_ask_before_unload:!1,draggable_modal:!0,toolbar_sticky:!1,toolbar_mode:"sliding",font_size_formats:"12px 14px 16px 18px 20px 22px 24px 26px 36px 48px 56px",line_height_default:1.5,line_height_formats:"1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2 3 4 5 12px 14px 16px 18px 20px 22px 24px 26px 36px 48px 56px",language:"zh_CN",language_url:"/tinymce/langs/zh_CN.js",quickbars_selection_toolbar:"bold italic underline strikethrough blockquote link",quickbars_insert_toolbar:!1,content_style:"body { font-family:Arial,sans-serif; font-size:14px; margin: 8px; padding: 0 } p { margin: 4px 0; padding: 0 }",font_family_formats:"微软雅黑='微软雅黑'; 宋体='宋体'; 黑体='黑体'; 仿宋='仿宋'; 楷体='楷体'; 隶书='隶书'; 幼圆='幼圆'; 方正舒体='方正舒体'; 方正姚体='方正姚体'; 等线='等线'; 华文彩云='华文彩云'; 华文仿宋='华文仿宋'; 华文行楷='华文行楷'; 华文楷体='华文楷体'; 华文隶书='华文隶书'; Andale Mono=andale mono,times; Arial=arial; Arial Black=arial black;avant garde; Book Antiqua=book antiqua;palatino; Comic Sans MS=comic sans ms; Courier New=courier new;courier; Georgia=georgia; Helvetica=helvetica; Impact=impact;chicago; Symbol=symbol; Tahoma=tahoma;arial; sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms; Verdana=verdana;geneva; Webdings=webdings; Wingdings=wingdings",plugins:"importcss image preview autolink directionality fullscreen link charmap advlist lists wordcount help quickbars emoticons wordcount code",toolbar:"undo redo ltr rtl blocks fontfamily fontsize bold italic underline strikethrough subscript superscript align blockquote numlist bullist link lineheight outdent indent forecolor backcolor removeformat charmap emoticons image fullscreen preview code empty wordcount",textpattern_patterns:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],paste_data_images:!0,images_upload_handler:K,image_advtab:!1,setup:e=>{e.on("keydown",n=>{9===n.keyCode&&(n.shiftKey?e.execCommand("Outdent"):e.execCommand("Indent"),n.preventDefault(),n.stopPropagation())}),e.ui.registry.addIcon("clear-content",'\n        <svg viewBox="0 0 1024 1024" width="20" height="20">\n          <path d="M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6c-0.3 1.5-0.4 3-0.4 4.4 0 14.4 11.6 26 26 26h723c1.5 0 3-0.1 4.4-0.4 14.2-2.4 23.7-15.9 21.2-30zM204 390h272V182h72v208h272v104H204V390z m468 440V674c0-4.4-3.6-8-8-8h-48c-4.4-0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"/>\n        </svg>\n      '),e.ui.registry.addButton("empty",{icon:"clear-content",tooltip:"清空内容",onAction:()=>{e.setContent("")}})}},n=e.setup;return e.setup=e=>{n&&n(e),e.ui.registry.addButton("empty",{icon:"clear-content",tooltip:"清空内容",onAction:()=>{u.value="",e.setContent("")}})},{...e,height:a.height,placeholder:a.placeholder,...a.customConfig,init_instance_callback:e=>{r.value=!0}}});return n({resetContent:()=>{u.value=""}}),(n,t)=>{const o=b("el-skeleton");return _(),m("div",{class:f(["tinymce-wrapper",{"is-disabled":e.disabled}])},[g(h(N),{id:S.value,ref_key:"editorRef",ref:i,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),disabled:e.disabled,init:w.value,tinymceScriptSrc:h("/tinymce/tinymce.min.js")},null,8,["id","modelValue","disabled","init","tinymceScriptSrc"]),r.value?y("",!0):(_(),v(o,{key:0,rows:7,animated:""}))],2)}}}),[["__scopeId","data-v-4b6f7640"]]);export{F as T};
