import{T as e}from"./tinyMceEditor-EOAlt4H2.js";import{r as a}from"./index-BT6KgQx3.js";import{u as l}from"./useLoading-D-rekEU2.js";import{y as i,r as s,X as c,l as r,j as t,z as o,R as n,al as d,J as p,I as m,L as h,Q as u,a6 as b,B as E,P as f,u as g,O as y,A as j}from"./vue-BMnUnhjY.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";const v={class:"academic-form-editor"},D={class:"section-title"},P={class:"editor-wrapper"},k={class:"editor-wrapper"},V={key:1,class:"section-switches"},_={class:"section-title"},A={class:"editor-wrapper"},R={class:"editor-wrapper"},U={class:"form-buttons"},z=w(i({__name:"academicFormEditor",props:{userId:{type:String,required:!0},initialData:{type:Object,default:()=>({})},isDisabled:{type:Boolean,default:!1},showButtons:{type:Boolean,default:!0}},emits:["save","cancel","update"],setup(i,{expose:w,emit:z}){const x=i,I=z,O=s(),{loading:B,closeLoading:F}=l({target:".academic-form-editor"});c(()=>{F()});const S=s(["个人简介","研究方向"]),L=s([]),q=s({}),J=r({bio:"",bioEn:"",researchDirection:"",researchDirectionEn:"",researchProject:"",researchProjectEn:"",academicAppointment:"",academicAppointmentEn:"",awards:"",awardsEn:"",academicResearch:"",academicResearchEn:"",publications:"",publicationsEn:"",sections:{projects:!1,academic:!1,awards:!1,research:!1,papers:!1}}),N={bio:[{required:!0,message:"请输入中文个人简介",trigger:"change"}],researchDirection:[{required:!0,message:"请输入中文研究方向",trigger:"blur"}]},C=[{title:"个人简介",fields:[{label:"简介(中文)",prop:"bio",placeholder:"请输入中文个人简介",lang:"zh"},{label:"简介(英文)",prop:"bioEn",placeholder:"please enter your bio in English",lang:"en"}]},{title:"研究方向",fields:[{label:"研究方向(中文)",prop:"researchDirection",placeholder:"请输入中文研究方向",lang:"zh"},{label:"研究方向(英文)",prop:"researchDirectionEn",placeholder:"Please enter your research directions in English",lang:"en"}]}],M=[{key:"projects",title:"课题项目",fields:[{label:"课题项目(中文)",prop:"researchProject",placeholder:"请输入中文课题项目，每个项目一行",lang:"zh"},{label:"课题项目(英文)",prop:"researchProjectEn",placeholder:"Please enter your projects in English, one per line",lang:"en"}]},{key:"academic",title:"学术兼职",fields:[{label:"学术兼职(中文)",prop:"academicAppointment",placeholder:"请输入中文学术兼职，每个兼职一行",lang:"zh"},{label:"学术兼职(英文)",prop:"academicAppointmentEn",placeholder:"Please enter your academic positions in English, one per line",lang:"en"}]},{key:"awards",title:"获奖情况",fields:[{label:"获奖情况(中文)",prop:"awards",placeholder:"请输入中文获奖情况，每个奖项一行",lang:"zh"},{label:"获奖情况(英文)",prop:"awardsEn",placeholder:"Please enter your awards in English, one per line",lang:"en"}]},{key:"research",title:"学术研究",fields:[{label:"学术研究(中文)",prop:"academicResearch",placeholder:"请输入中文学术研究内容",lang:"zh"},{label:"学术研究(英文)",prop:"academicResearchEn",placeholder:"Please enter your academic research in English",lang:"en"}]},{key:"papers",title:"论文发表",fields:[{label:"论文发表(中文)",prop:"publications",placeholder:"请输入中文论文发表信息，每篇论文一行",lang:"zh"},{label:"论文发表(英文)",prop:"publicationsEn",placeholder:"Please enter your published papers in English, one per line",lang:"en"}]}],Q=()=>{S.value=C.map(e=>e.title),L.value=M.filter(e=>J.sections[e.key]).map(e=>e.key)},T=e=>{q.value=JSON.parse(JSON.stringify(e||{})),J.bio=e.bio||"",J.bioEn=e.bioEn||"",J.researchDirection=e.researchDirection||"",J.researchDirectionEn=e.researchDirectionEn||"",Object.keys(J.sections).forEach(e=>{J.sections[e]=!1}),J.researchProject="",J.researchProjectEn="",J.academicAppointment="",J.academicAppointmentEn="",J.awards="",J.awardsEn="",J.academicResearch="",J.academicResearchEn="",J.publications="",J.publicationsEn="",(e.researchProject||e.researchProjectEn)&&(J.researchProject=e.researchProject||"",J.researchProjectEn=e.researchProjectEn||"",J.sections.projects=!0),(e.academicAppointment||e.academicAppointmentEn)&&(J.academicAppointment=e.academicAppointment||"",J.academicAppointmentEn=e.academicAppointmentEn||"",J.sections.academic=!0),(e.awards||e.awardsEn)&&(J.awards=e.awards||"",J.awardsEn=e.awardsEn||"",J.sections.awards=!0),(e.academicResearch||e.academicResearchEn)&&(J.academicResearch=e.academicResearch||"",J.academicResearchEn=e.academicResearchEn||"",J.sections.research=!0),(e.publications||e.publicationsEn)&&(J.publications=e.publications||"",J.publicationsEn=e.publicationsEn||"",J.sections.papers=!0)},W=()=>{O.value&&!B.value&&O.value.validate(e=>{if(e){const e={bio:a(J.bio),bioEn:a(J.bioEn),researchDirection:a(J.researchDirection),researchDirectionEn:a(J.researchDirectionEn),researchProject:J.sections.projects?a(J.researchProject):"",researchProjectEn:J.sections.projects?a(J.researchProjectEn):"",academicAppointment:J.sections.academic?a(J.academicAppointment):"",academicAppointmentEn:J.sections.academic?a(J.academicAppointmentEn):"",awards:J.sections.awards?a(J.awards):"",awardsEn:J.sections.awards?a(J.awardsEn):"",academicResearch:J.sections.research?a(J.academicResearch):"",academicResearchEn:J.sections.research?a(J.academicResearchEn):"",publications:J.sections.papers?a(J.publications):"",publicationsEn:J.sections.papers?a(J.publicationsEn):""};I("save",{...e,userId:x.userId})}else Q()})},X=()=>{T(q.value),I("cancel")};return t(()=>x.initialData,e=>{e&&Object.keys(e).length>0&&(T(e),S.value=C.map(e=>e.title),L.value=M.filter(e=>J.sections[e.key]).map(e=>e.key))},{deep:!0,immediate:!0}),t(()=>x.isDisabled,()=>{O.value&&O.value.clearValidate()}),w({formRef:O,getFormData:()=>({bio:J.bio,bioEn:J.bioEn,researchDirection:J.researchDirection,researchDirectionEn:J.researchDirectionEn,...J.sections.projects?{researchProject:J.researchProject,researchProjectEn:J.researchProjectEn}:{},...J.sections.academic?{academicAppointment:J.academicAppointment,academicAppointmentEn:J.academicAppointmentEn}:{},...J.sections.awards?{awards:J.awards,awardsEn:J.awardsEn}:{},...J.sections.research?{academicResearch:J.academicResearch,academicResearchEn:J.academicResearchEn}:{},...J.sections.papers?{publications:J.publications,publicationsEn:J.publicationsEn}:{}}),saveForm:W,cancelEdit:X,initForm:T,expandAllSections:Q,collapseAllSections:()=>{S.value=[],L.value=[]}}),(a,l)=>{const s=d("el-tab-pane"),c=d("el-tabs"),r=d("el-form-item"),t=d("el-collapse-item"),w=d("el-collapse"),z=d("el-divider"),x=d("el-checkbox"),I=d("el-button"),F=d("el-form");return j(),o("div",v,[n(F,{ref_key:"formRef",ref:O,model:J,rules:N,labelWidth:"120px",statusIcon:""},{default:p(()=>[n(w,{modelValue:S.value,"onUpdate:modelValue":l[0]||(l[0]=e=>S.value=e)},{default:p(()=>[(j(),o(u,null,b(C,a=>n(t,{key:a.title,name:a.title},{title:p(()=>[E("span",D,f(a.title),1)]),default:p(()=>[n(r,{label:a.title,class:"content-form-item"},{default:p(()=>[n(c,{type:"border-card",class:"simple-tabs"},{default:p(()=>[n(s,{label:"中文内容"},{default:p(()=>[E("div",P,[n(e,{modelValue:J[a.fields[0].prop],"onUpdate:modelValue":e=>J[a.fields[0].prop]=e,disabled:i.isDisabled,placeholder:a.fields[0].placeholder,height:500},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])])]),_:2},1024),n(s,{label:"英文内容"},{default:p(()=>[E("div",k,[n(e,{modelValue:J[a.fields[1].prop],"onUpdate:modelValue":e=>J[a.fields[1].prop]=e,disabled:i.isDisabled,placeholder:a.fields[1].placeholder,height:500},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["label"])]),_:2},1032,["name"])),64))]),_:1},8,["modelValue"]),i.isDisabled?h("",!0):(j(),m(z,{key:0,contentPosition:"left"},{default:p(()=>[...l[2]||(l[2]=[E("span",{class:"section-title"},"选择显示内容",-1)])]),_:1})),i.isDisabled?h("",!0):(j(),o("div",V,[(j(),o(u,null,b(M,(e,a)=>n(x,{key:a,modelValue:J.sections[e.key],"onUpdate:modelValue":a=>J.sections[e.key]=a,label:e.title,size:"large"},null,8,["modelValue","onUpdate:modelValue","label"])),64))])),n(w,{modelValue:L.value,"onUpdate:modelValue":l[1]||(l[1]=e=>L.value=e)},{default:p(()=>[(j(),o(u,null,b(M,a=>(j(),o(u,{key:`opt-${a.key}`},[J.sections[a.key]?(j(),m(t,{key:0,name:a.key},{title:p(()=>[E("span",_,f(a.title),1)]),default:p(()=>[n(r,{label:a.title,class:"content-form-item"},{default:p(()=>[n(c,{type:"border-card",class:"simple-tabs"},{default:p(()=>[n(s,{label:"中文内容"},{default:p(()=>[E("div",A,[n(e,{modelValue:J[a.fields[0].prop],"onUpdate:modelValue":e=>J[a.fields[0].prop]=e,disabled:i.isDisabled,placeholder:a.fields[0].placeholder,height:500},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])])]),_:2},1024),n(s,{label:"英文内容"},{default:p(()=>[E("div",R,[n(e,{modelValue:J[a.fields[1].prop],"onUpdate:modelValue":e=>J[a.fields[1].prop]=e,disabled:i.isDisabled,placeholder:a.fields[1].placeholder,height:500},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["label"])]),_:2},1032,["name"])):h("",!0)],64))),64))]),_:1},8,["modelValue"]),i.showButtons&&!i.isDisabled?(j(),m(r,{key:2},{default:p(()=>[E("div",U,[n(I,{type:"primary",loading:g(B),onClick:W},{default:p(()=>[...l[3]||(l[3]=[y(" 保存 ",-1)])]),_:1},8,["loading"]),n(I,{onClick:X},{default:p(()=>[...l[4]||(l[4]=[y(" 取消 ",-1)])]),_:1})])]),_:1})):h("",!0)]),_:1},8,["model"])])}}}),[["__scopeId","data-v-bca8913b"]]);export{z as A};
