import{y as e,r as l,ay as t,c as a,l as o,h as r,z as s,B as i,P as d,R as n,J as u,al as p,u as c,Q as m,a6 as g,I as f,aD as b,A as h}from"./vue-BMnUnhjY.js";import{S as y,g as _,ag as v,E as V}from"./elementPlus-iRxZk2_b.js";import{H as E}from"./headerLine-ALaI24G7.js";import{a as U,s as T}from"./index-BT6KgQx3.js";import{u as x}from"./useLoading-D-rekEU2.js";import{u as A}from"./useDictionary-Cg9QFWfd.js";import{_ as L}from"./_plugin-vue_export-helper-BCo6x5W8.js";const z={class:"modify-tool-container"},j={class:"card-header"},w={class:"header-buttons"},Z={class:"custom-card box-card"},q={class:"card-body"},I=L(e({__name:"modifyToolInfos",setup(e){const L=/^(https?:\/\/)([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?(\/[a-zA-Z0-9._~:/?#[\]@!$&'()*+,;=]*)?$/,I=t(),P=b(),R=U(),{loading:S,changeLoading:k,closeLoading:C}=x(),$=A({dictType:"opensource_tool_type",autoLoad:!0}),D=l(I.query.mode||"add"),H=l(I.query.id),B=l(),F=a(()=>"add"===D.value?"新增工具":J.title?`【${J.title}】编辑`:"编辑工具"),J=o({id:"",title:"",titleEn:"",description:"",descriptionEn:"",toolType:"",toolUrl:"",publishStatus:"0"}),M={title:[{required:!0,message:"请输入工具中文标题",trigger:"blur"},{max:200,message:"标题长度不能超过200个字符",trigger:"blur"}],titleEn:[{max:200,message:"标题长度不能超过200个字符",trigger:"blur"}],toolType:[{required:!0,message:"请选择工具类型",trigger:"change"}],toolUrl:[{required:!0,message:"请输入工具地址",trigger:"blur"},{max:500,message:"地址长度不能超过500个字符",trigger:"blur"},{validator:(e,l,t)=>{l?/^https?:\/\//i.test(l)?L.test(l)?t():t(new Error("请输入有效的URL地址")):t(new Error("URL必须以http://或https://开头")):t(new Error("请输入工具地址"))},trigger:"blur"}]},Q=()=>{B.value?.validate(e=>{if(e){const e="/api/tool/save";k(!0),T.post(e,J).then(()=>{V.success({message:("add"===D.value?"新增":"编辑")+"成功",type:"success",duration:2e3});const e=R.getCurTabPath;e&&R.delCurTab(e,P,"/toolManage")}).finally(()=>{C()})}else V.error({message:"请填写必填项",type:"error"})})};return r(()=>{"edit"===D.value&&H.value&&(k(!0),T.post("/api/tool/detail",{id:H.value}).then(e=>{e&&(J.id=e.id,J.title=e.title,J.titleEn=e.titleEn,J.description=e.description,J.descriptionEn=e.descriptionEn,J.toolType=e.toolType,J.toolUrl=e.toolUrl,J.publishStatus=e.publishStatus)}).finally(()=>{C()}))}),(e,l)=>{const t=p("el-button"),a=p("el-tooltip"),o=p("el-input"),r=p("el-form-item"),b=p("el-col"),V=p("el-row"),U=p("el-option"),T=p("el-select"),x=p("el-form");return h(),s("div",z,[i("div",j,[i("h2",null,d(F.value),1),i("div",w,[n(a,{content:"保存",placement:"top",showAfter:200,hideAfter:0},{default:u(()=>[n(t,{type:"primary",circle:"",icon:c(y),loading:c(S),onClick:Q},null,8,["icon","loading"])]),_:1})])]),i("div",Z,[i("div",q,[n(x,{ref_key:"formRef",ref:B,model:J,rules:M,labelWidth:"150px",labelPosition:"right"},{default:u(()=>[n(E,{title:"基本信息",icon:c(_)},null,8,["icon"]),n(V,{gutter:24},{default:u(()=>[n(b,{span:12},{default:u(()=>[n(r,{label:"工具标题（中文）",prop:"title"},{default:u(()=>[n(o,{modelValue:J.title,"onUpdate:modelValue":l[0]||(l[0]=e=>J.title=e),placeholder:"请输入工具中文标题",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),n(b,{span:12},{default:u(()=>[n(r,{label:"工具标题（英文）",prop:"titleEn"},{default:u(()=>[n(o,{modelValue:J.titleEn,"onUpdate:modelValue":l[1]||(l[1]=e=>J.titleEn=e),placeholder:"请输入工具英文标题",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(V,{gutter:24},{default:u(()=>[n(b,{span:12},{default:u(()=>[n(r,{label:"工具类型",prop:"toolType"},{default:u(()=>[n(T,{modelValue:J.toolType,"onUpdate:modelValue":l[2]||(l[2]=e=>J.toolType=e),placeholder:"请选择工具类型",clearable:""},{default:u(()=>[(h(!0),s(m,null,g(c($).dictList.value,e=>(h(),f(U,{key:e.dictId,label:e.dictValue,value:e.dictId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(b,{span:12},{default:u(()=>[n(r,{label:"工具地址",prop:"toolUrl"},{default:u(()=>[n(o,{modelValue:J.toolUrl,"onUpdate:modelValue":l[3]||(l[3]=e=>J.toolUrl=e),placeholder:"请输入工具地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(E,{title:"工具描述",icon:c(v)},null,8,["icon"]),n(r,{label:"工具描述（中文）",prop:"description",class:"content-item"},{default:u(()=>[n(o,{modelValue:J.description,"onUpdate:modelValue":l[4]||(l[4]=e=>J.description=e),type:"textarea",rows:8,placeholder:"请输入工具描述（中文）"},null,8,["modelValue"])]),_:1}),n(r,{label:"工具描述（英文）",prop:"descriptionEn",class:"content-item"},{default:u(()=>[n(o,{modelValue:J.descriptionEn,"onUpdate:modelValue":l[5]||(l[5]=e=>J.descriptionEn=e),type:"textarea",rows:8,placeholder:"请输入工具描述（英文）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])])])}}}),[["__scopeId","data-v-e5091683"]]);export{I as default};
