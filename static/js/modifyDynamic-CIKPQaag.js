import{y as e,r as l,ay as a,l as t,h as d,z as i,B as o,P as n,R as s,J as r,al as u,u as c,Q as p,a6 as m,I as y,aD as f,A as h}from"./vue-BMnUnhjY.js";import{S as b,g,c as _,E as v}from"./elementPlus-iRxZk2_b.js";import{T as V}from"./tinyMceEditor-EOAlt4H2.js";import{H as E}from"./headerLine-ALaI24G7.js";import{a as D,p as T,s as L}from"./index-BT6KgQx3.js";import{u as j}from"./useLoading-D-rekEU2.js";import{u as q}from"./useDictionary-Cg9QFWfd.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";const x={class:"modify-dynamic-container"},U={class:"card-header"},k={class:"header-buttons"},I={class:"custom-card box-card"},M={class:"card-body"},P={class:"editor-wrapper"},S={class:"editor-wrapper"},Y=w(e({__name:"modifyDynamic",setup(e){const w=D(T),{dictList:Y}=q({dictType:"dynamic_type",autoLoad:!0}),{changeLoading:A,closeLoading:C,loading:W}=j(),F=a(),H=f(),R=l(F.query.mode||"add"),z=l(F.query.id),B=l(),J=t({id:"",dynamicType:"6001",title:"",titleEn:"",content:"",contentEn:"",publishStatus:"0",publishDate:""}),N={dynamicType:[{required:!0,message:"请选择类型",trigger:"change"}],title:[{required:!0,message:"请输入动态标题",trigger:"blur"},{max:100,message:"标题长度不能超过100个字符",trigger:"blur"}],content:[{required:!0,message:"请输入中文动态内容",trigger:"blur"}]},Q=()=>{B.value?.validate(e=>{if(!e)return;A(!0);L.post("/api/dynamic/save",J).then(()=>{v.success("保存成功");const e=w.getCurTabPath;e&&w.delCurTab(e,H,"/dynamicManage")}).finally(()=>{C()})})};return d(()=>{"edit"===R.value&&z.value&&(A(!0),L.post("/api/dynamic/detail",{id:z.value}).then(e=>{e&&(J.id=e.id,J.title=e.title,J.titleEn=e.titleEn,J.dynamicType=e.dynamicType,J.content=e.content,J.contentEn=e.contentEn,J.publishStatus=e.publishStatus,J.publishDate=e.publishDate||null)}).finally(()=>{C()}))}),(e,l)=>{const a=u("el-icon"),t=u("el-button"),d=u("el-tooltip"),f=u("el-input"),v=u("el-form-item"),D=u("el-option"),T=u("el-select"),L=u("el-col"),j=u("el-date-picker"),q=u("el-row"),w=u("el-tab-pane"),A=u("el-tabs"),C=u("el-form");return h(),i("div",x,[o("div",U,[o("h2",null,n("edit"===R.value?"编辑动态":"新增动态"),1),o("div",k,[s(d,{content:"保存",placement:"top",showAfter:200,hideAfter:0},{default:r(()=>[s(t,{type:"primary",circle:"",loading:c(W),onClick:Q},{default:r(()=>[s(a,null,{default:r(()=>[s(c(b))]),_:1})]),_:1},8,["loading"])]),_:1})])]),o("div",I,[o("div",M,[s(C,{ref_key:"formRef",ref:B,model:J,rules:N,labelWidth:"100px",class:"dynamic-form"},{default:r(()=>[s(E,{title:"基本信息",icon:c(g)},null,8,["icon"]),s(v,{label:"动态标题",prop:"title",required:""},{default:r(()=>[s(f,{modelValue:J.title,"onUpdate:modelValue":l[0]||(l[0]=e=>J.title=e),placeholder:"请输入动态标题",maxlength:"100",showWordLimit:""},null,8,["modelValue"])]),_:1}),s(v,{label:"英文标题",prop:"titleEn"},{default:r(()=>[s(f,{modelValue:J.titleEn,"onUpdate:modelValue":l[1]||(l[1]=e=>J.titleEn=e),placeholder:"请输入英文标题",maxlength:"100",showWordLimit:""},null,8,["modelValue"])]),_:1}),s(q,{gutter:24},{default:r(()=>[s(L,{span:12},{default:r(()=>[s(v,{label:"类型",prop:"dynamicType",required:""},{default:r(()=>[s(T,{modelValue:J.dynamicType,"onUpdate:modelValue":l[2]||(l[2]=e=>J.dynamicType=e),placeholder:"请选择类型",style:{width:"100%"}},{default:r(()=>[(h(!0),i(p,null,m(c(Y),e=>(h(),y(D,{key:e.dictId,label:e.dictValue,value:e.dictId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(L,{span:12},{default:r(()=>[s(v,{label:"发布日期",prop:"publishDate"},{default:r(()=>[s(j,{modelValue:J.publishDate,"onUpdate:modelValue":l[3]||(l[3]=e=>J.publishDate=e),type:"date",placeholder:"请选择动态发布日期",valueFormat:"YYYY-MM-DD",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(E,{title:"动态内容",icon:c(_)},null,8,["icon"]),s(v,{label:"内容",prop:"content",required:"",class:"content-form-item"},{default:r(()=>[s(A,{type:"border-card",class:"simple-tabs"},{default:r(()=>[s(w,{label:"中文内容"},{default:r(()=>[o("div",P,[s(V,{modelValue:J.content,"onUpdate:modelValue":l[4]||(l[4]=e=>J.content=e),height:500,placeholder:"请输入中文动态内容"},null,8,["modelValue"])])]),_:1}),s(w,{label:"英文内容"},{default:r(()=>[o("div",S,[s(V,{modelValue:J.contentEn,"onUpdate:modelValue":l[5]||(l[5]=e=>J.contentEn=e),height:500,placeholder:"请输入英文动态内容"},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])])}}}),[["__scopeId","data-v-c9808665"]]);export{Y as default};
