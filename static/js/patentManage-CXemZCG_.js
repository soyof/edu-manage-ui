import{y as e,r as t,c as a,z as l,R as o,J as i,al as n,B as s,P as p,u,O as r,I as d,L as c,E as h,Q as f,a6 as m,aD as w,A as b}from"./vue-BMnUnhjY.js";import{u as v,s as _}from"./index-BT6KgQx3.js";import{e as g,w as S,S as T,a3 as y,a4 as V,E as U,C as k}from"./elementPlus-iRxZk2_b.js";import{_ as C}from"./throttleButton.vue_vue_type_script_setup_true_lang-D3gBfjRi.js";import{T as D}from"./tablePage-YHXugbiE.js";import{b as O}from"./statusConfig-Cju3zQbK.js";import{_ as P}from"./_plugin-vue_export-helper-BCo6x5W8.js";const A={class:"patent-manage-container common-action-column"},I=["title","onClick"],R={class:"action-buttons"},N=["onClick"],x=["onClick"],Y=["onClick"],j=P(e({__name:"patentManage",setup(e){const P=w(),j=v(),z=j.isAdmin,B={title:"",titleEn:"",applicationNum:"",publishStatus:"",applicationDateRange:[],authorizationDateRange:[]},M=t(null),$=t([]),F=a(()=>0===$.value.length||$.value.some(e=>"1"===e.publishStatus)),q=e=>_.post("/api/patent/list",e),E=e=>{$.value=e},L=()=>{P.push({path:"/modifyPatentInfos",query:{mode:"add",tabTitle:encodeURIComponent("新增专利")}})},J=e=>{const t=!e,a=j.getUserInfo.value;if(t&&0===$.value.length)return void U.warning("请选择要删除的专利");if(t&&$.value.some(e=>"1"===e.publishStatus))return void U.warning("已发布的专利不能删除");if(!t&&"1"===e?.publishStatus)return void U.warning("已发布的专利不能删除");if(!z.value)if(t){if($.value.some(e=>e.createUserName!==a?.username))return void U.warning("您只能删除自己创建的专利")}else if(e&&e.createUserName!==a?.username)return void U.warning("您只能删除自己创建的专利");const l=t?$.value.map(e=>e.id):e.id,o=t?`确认删除选中的 ${$.value.length} 条专利信息吗？`:"确认删除该专利信息吗？";k.confirm(o,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.post("/api/patent/delete",{ids:l}).then(()=>{U.success("删除成功"),K(1)})}).catch(()=>{})},K=e=>{M.value&&M.value.getList(e)};return(e,t)=>{const a=n("el-input"),w=n("el-form-item"),v=n("el-col"),j=n("el-option"),$=n("el-select"),Q=n("el-date-picker"),W=n("el-icon"),G=n("el-tooltip"),H=n("el-table-column"),X=n("el-tag");return b(),l("div",A,[o(D,{ref_key:"tablePageRef",ref:M,fetchData:q,initialSearchForm:B,onSelectionChange:E},{"search-form":i(({form:e})=>[o(v,{span:6},{default:i(()=>[o(w,{label:"专利名称"},{default:i(()=>[o(a,{modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,placeholder:"请输入专利名称",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(v,{span:6},{default:i(()=>[o(w,{label:"申请号"},{default:i(()=>[o(a,{modelValue:e.applicationNum,"onUpdate:modelValue":t=>e.applicationNum=t,placeholder:"请输入申请号",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(v,{span:6},{default:i(()=>[o(w,{label:"发布状态"},{default:i(()=>[o($,{modelValue:e.publishStatus,"onUpdate:modelValue":t=>e.publishStatus=t,placeholder:"请选择发布状态",clearable:""},{default:i(()=>[(b(!0),l(f,null,m(u(O).list,e=>(b(),d(j,{key:e.dictId,label:e.dictValue,value:e.dictId},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(v,{span:6},{default:i(()=>[o(w,{label:"申请日期"},{default:i(()=>[o(Q,{modelValue:e.applicationDateRange,"onUpdate:modelValue":t=>e.applicationDateRange=t,type:"daterange",rangeSeparator:"~",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(v,{span:6},{default:i(()=>[o(w,{label:"授权日期"},{default:i(()=>[o(Q,{modelValue:e.authorizationDateRange,"onUpdate:modelValue":t=>e.authorizationDateRange=t,type:"daterange",rangeSeparator:"~",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),operation:i(()=>[o(G,{content:"新增专利",placement:"top",showAfter:200,hideAfter:0},{default:i(()=>[o(C,{size:"small",type:"primary",onClick:L},{default:i(()=>[o(W,null,{default:i(()=>[o(u(V))]),_:1})]),_:1})]),_:1}),o(G,{content:"批量删除",placement:"top",showAfter:200,hideAfter:0},{default:i(()=>[o(C,{size:"small",type:"danger",disabled:F.value,onClick:t[0]||(t[0]=e=>J())},{default:i(()=>[o(W,null,{default:i(()=>[o(u(y))]),_:1})]),_:1},8,["disabled"])]),_:1})]),default:i(()=>[o(H,{type:"selection",width:"50",fixed:"left"}),o(H,{prop:"title",label:"专利名称",minWidth:"180",showOverflowTooltip:""},{default:i(e=>[s("span",{class:"clickable-title",title:e.row.title,onClick:t=>(e=>{const t=`专利详情【${e.title}】`;P.push({path:"/patentDetail",query:{mode:"view",id:String(e.id),tabTitle:encodeURIComponent(t)}})})(e.row)},p(e.row.title),9,I)]),_:1}),o(H,{prop:"applicationNum",label:"申请号",width:"120",showOverflowTooltip:""}),o(H,{prop:"applicants",label:"申请人",width:"150",showOverflowTooltip:""}),o(H,{prop:"publishStatus",label:"发布状态",width:"100",showOverflowTooltip:""},{default:i(e=>[o(X,{type:u(O).getTagType(e.row.publishStatus)},{default:i(()=>[r(p(u(O).getName(e.row.publishStatus)),1)]),_:2},1032,["type"])]),_:1}),o(H,{prop:"isServicePatent",label:"职务专利",width:"100",showOverflowTooltip:""},{default:i(e=>[o(X,{type:"1"===e.row.isServicePatent?"success":"info"},{default:i(()=>[r(p("1"===e.row.isServicePatent?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),o(H,{prop:"applicationDate",label:"申请日期",width:"120",showOverflowTooltip:""}),o(H,{prop:"authorizationDate",label:"授权日期",width:"120",showOverflowTooltip:""}),o(H,{prop:"patentPublishDate",label:"专利发布日期",width:"120",showOverflowTooltip:""}),o(H,{prop:"publishUserName",label:"发布人",width:"120",showOverflowTooltip:""}),o(H,{prop:"publishTimes",label:"发布时间",width:"180",showOverflowTooltip:""}),o(H,{prop:"updateUserName",label:"更新人",width:"100",showOverflowTooltip:""}),o(H,{prop:"updatedTimes",label:"更新时间",width:"180",showOverflowTooltip:""}),o(H,{prop:"createUserName",label:"创建人",width:"120",showOverflowTooltip:""}),o(H,{prop:"createdTimes",label:"创建时间",width:"180",showOverflowTooltip:""}),o(H,{label:"操作",width:"110",fixed:"right"},{default:i(e=>[s("div",R,[u(z)?(b(),d(G,{key:0,content:"1"===e.row.publishStatus?"已发布专利不可编辑":"编辑",placement:"top",showAfter:200,hideAfter:0},{default:i(()=>[s("span",{class:h(["action-icon-wrapper",{"disabled-wrapper":"1"===e.row.publishStatus}]),onClick:t=>"1"!==e.row.publishStatus&&(e=>{const t=`编辑专利【${e.title}】`;P.push({path:"/modifyPatentInfos",query:{mode:"edit",id:String(e.id),tabTitle:encodeURIComponent(t)}})})(e.row)},[o(W,{class:"action-icon edit-icon"},{default:i(()=>[o(u(g))]),_:1})],10,N)]),_:2},1032,["content"])):c("",!0),u(z)?(b(),d(G,{key:1,content:"1"===e.row.publishStatus?"下线":"发布",placement:"top",showAfter:200,hideAfter:0},{default:i(()=>[s("span",{class:"action-icon-wrapper",onClick:t=>((e,t)=>{const a="publish"===t,l=a?"发布":"下线";k.confirm(`确认${l}该专利吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:a?"info":"warning"}).then(()=>{_.post("/api/patent/publish",{id:e.id,action:t}).then(()=>{U.success(`${l}成功`),K(1)})}).catch(()=>{})})(e.row,"1"===e.row.publishStatus?"unpublish":"publish")},[o(W,{class:h(["action-icon","1"===e.row.publishStatus?"unpublish-icon":"publish-icon"])},{default:i(()=>["1"===e.row.publishStatus?(b(),d(u(S),{key:0})):(b(),d(u(T),{key:1}))]),_:2},1032,["class"])],8,x)]),_:2},1032,["content"])):c("",!0),o(G,{content:"1"===e.row.publishStatus?"已发布专利不能删除":"删除",placement:"top",showAfter:200,hideAfter:0},{default:i(()=>[s("span",{class:h(["action-icon-wrapper",{"disabled-wrapper":"1"===e.row.publishStatus}]),onClick:t=>"1"!==e.row.publishStatus&&J(e.row)},[o(W,{class:"action-icon delete-icon"},{default:i(()=>[o(u(y))]),_:1})],10,Y)]),_:2},1032,["content"])])]),_:1})]),_:1},512)])}}}),[["__scopeId","data-v-324b0fb6"]]);export{j as default};
